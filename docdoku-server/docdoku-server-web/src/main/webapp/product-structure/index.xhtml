<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html">
    <ui:composition template="/WEB-INF/templates/moduleTemplate.xhtml">
        <ui:define name="title">
            <f:loadBundle var="i18nPS" basename="com.docdoku.server.localization.explorer_resource"/>
            #{i18nPS['title']} - #{workspaceID} - #{productID}
        </ui:define>
        <ui:define name="styles">     
        <link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/jquery.treeview.css"/>
        <link rel="stylesheet/less" type="text/css" href="#{request.contextPath}/less/product-structure/style.less"/>
        </ui:define>
        <ui:define name="scripts"> 

        <script type="text/javascript" src="#{request.contextPath}/js/lib/modernizr.custom.js"></script>

        <script type="text/javascript" src="#{request.contextPath}/js/lib/visualization/three-r56.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/lib/visualization/BinaryLoader.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/lib/visualization/Stats.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/lib/visualization/threex.domevent.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/lib/visualization/threex.windowresize.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/lib/visualization/VisualizationUtils.js"></script>

        <script type="text/javascript" src="#{request.contextPath}/js/product-structure/FirstPersonControlsCustom.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/product-structure/PointerLockControlsCustom.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/product-structure/TrackballControlsCustom.js"></script>

        <script type="text/javascript" src="#{request.contextPath}/js/product-structure/models/instance.js"></script>
        <script type="text/javascript" src="#{request.contextPath}/js/product-structure/models/levelGeometry.js"></script>

        <script type="text/javascript">
            var APP_CONFIG = {
                workspaceId: "${workspaceID}",
                productId: "${productID}",
                login: "${login}",
                sessionId: "${session.id}"
            };

            var SCENE_INIT = {};

            var isIpad = navigator.userAgent.indexOf("iPad") != -1;

            $(document).ready(function() {

                require.config({
                    baseUrl: "${request.contextPath}/js/product-structure",
                    paths: {

                        "require": "../lib/require/require.min-2.1.2",
                        "text": "../lib/require/text-2.0.3",
                        "i18n": "../lib/require/i18n-2.0.1",
                        "localization": "../localization",
                        "modules":"../modules",
                        "common-objects":"../common-objects"
                    },
                    config: {
                        i18n: {
                            locale: "#{request.locale.language}"
                        }
                    }
                });

                require(["app"], function(AppView) {
                    new AppView();
                });

                require(["modules/user-popover-module/app",
                         "modules/chat-module/app",
                         "modules/webrtc-module/app",
                         "modules/coworkers-access-module/app"
                ]);

            });                
        </script>
        </ui:define>
        
        <ui:define name="content">
            
                <div id="product-menu">

                    <div id="product-menu-inner">

                    <div id="nav_list_action_bar">

                        <div id="nav_list_controls">
                            <div id="search_control_container">
                                <form id="nav_list_search">
                                    <input type="text" name="search"/>
                                    <button class="btn btn-custom icon-search " id="nav_list_search_button" value=""></button>
                                </form>
                            </div>

                        </div>
                    </div>

                    <div id="product_nav_list_container">
                        <nav class="nav nav-list treeview" id="product_nav_list">
                            <div id='product_title'><i class="icon-briefcase"></i> ${productID}</div>
                        </nav>
                    </div>

                    <div id="config_spec_container">
                        <span>Config Spec</span>
                        <select id="context_selector_list">
                            <option selected="">Latest</option>
                        </select>
                    </div>
                    </div>
                </div>

                <div id="product-content">

                    <div id="top_controls_container" class="actions well">
                        <div class="btn-group" data-toggle="buttons-radio" id="top_buttons">
                            <button class="btn btn-custom active" id="scene_view_btn"><i class="icon-eye-open"></i></button>
                            <button class="btn btn-custom" id="bom_view_btn"><i class="icon-list"></i></button>
                        </div>
                        <button class="btn btn-custom" id="export_scene_btn"><i class="icon-upload-alt"></i> <b>Export</b></button>
                        <button class="btn btn-custom" id="fullscreen_scene_btn"><i class="icon-fullscreen"></i> <b>Full screen</b></button>
                        <div id="progress_bar_container" class="progress progress-striped active"></div>
                    </div>

                    <div id="center_container">
                        <div id="side_controls_container">
                            <div id="shortcuts">
                                <a>
                                    Keyboard / mouse shortcuts <i class="icon-cog"></i>
                                </a>
                            </div>
                            <div class="btn-group" data-toggle="buttons-radio" id="view_buttons">
                                <button class="btn btn-custom" id="flying_mode_view_btn"><i class="icon-fighter-jet"></i></button>
                                <button class="btn btn-custom" id="tracking_mode_view_btn"><i class="icon-magnet"></i></button>
                            </div>
                            <div class="btn-group" id="manageMarker">
                                <button class="btn btn-custom" id="markerZoomLess"><i class="icon-minus"></i></button>
                                <button class="btn btn-custom" id="markerState"><i class="icon-circle"></i></button>
                                <button class="btn btn-custom" id="markerZoomMore"><i  class="icon-plus"></i></button>
                            </div>
                            <div id="layer-wrapper"><ul id="layer-header"></ul><nav><ul></ul></nav></div>
                        </div>
                        <div id="scene_container">
                            <div id="container">
                                <div id="blocker">
                                    <div id="instructions">
                                        <span style="font-size:40px">Double cliquez pour lancer la visualisation</span>
                                        <br />
                                        (Z, Q, S, D = Move, SPACE = Up, CTRL = Down, MOUSE = Look around, ESC = Quit)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="bom_table_container"></div>

                    <div id="part_metadata_container" class="minimized"></div>

                </div>

        </ui:define>
    </ui:composition>
</html>
